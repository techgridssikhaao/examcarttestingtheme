"use strict";var STCountdown=function(){};STCountdown.timer=function(e,t,n,o){let i=t-e;var l,s=864e5,r=36e5,a=6e4,c=1e3,d=function(){if(i>0){var e=i,t=Math.floor(e/s);e%=s;var l=Math.floor(e/r);e%=r;var d=Math.floor(e/a);e%=a;var h=Math.floor(e/c);n({days:t,hours:l,minutes:d,seconds:h}),i-=1e3}else i-=1e3,clearInterval(u),o()},u=setInterval((l=this,function(){d.call(l)}),1e3);return d.call(this),{abort:function(){clearInterval(u)},getTimeRemaining:function(){var e=i,t=Math.floor(e/s);e%=s;var n=Math.floor(e/r);e%=r;var o=Math.floor(e/a);return e%=a,{days:t,hours:n,minutes:o,seconds:Math.floor(e/c)}}}},function(e){var t="countdown",n="",o="countdown-handles";const i=new RegExp(/\/.*\.(?:png|jpg|jpeg|gif|svg|webp)/g),l=new RegExp(/(.*\.(?:png|jpg|svg|webp|jpeg|gif|php|js))/g);var s=null;const r={};let a=setInterval((()=>{window.STBASE&&(window.STBASE.getShopURL()&&function(){if(""!==window.STBASE.getTemplate())d().then((e=>console.info("[ST] loaded Countdown")));else{let e=setInterval((()=>{""!==window.STBASE.getTemplate()&&(d().then((e=>console.info("[ST] loaded Countdown"))),clearInterval(e))}),5)}if(window.location.pathname.indexOf("/products/")>=0){const e=window.location.href.split("#")[0].split("?")[0].split("/products/");2===e.length&&(s=decodeURIComponent(e[1]))}c().then((e=>console.info("[ST] loaded Countdown"))),setInterval((()=>{c().catch((e=>console.log(e)))}),1e3)}(),clearInterval(a))}),5);async function c(){let t=window.STBASE.getTemplate();const n=e.body.classList.contains("stSingleCountdownLoaded"),a=[];s&&!n&&(a.push(s),e.body.classList.add("stSingleCountdownLoaded"));let c=function(){let t='a[href*="/products/"]:not(.stCountdownLoaded)';return e.querySelectorAll(t)}();if(c.length)for(let e=0;e<c.length;e++){let t=c[e].getAttribute("href");if(t&&null===t.match(l)){const e=t.split("#")[0].split("?")[0].split("/products/");2===e.length&&a.push(decodeURIComponent(e[1]))}c[e].classList.add("stCountdownLoaded")}if(a.length){let n={handles:[...new Set(a)],shop:window.STBASE.getShopURL(),template:t};await fetch(window.STBASE.apiUrl+o,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>e.json())).then((async({data:t})=>{const{countdowns:n,productHandles:o}=t;n&&function(e){const t={};let n="";if(e.map((e=>{const{editorData:o}=e,{fontFamily:i,titleFontWeight:l,subTitleFontWeight:s,labelFontWeight:a,numberFontWeight:c}=o;i?.fontFamily&&(t.hasOwnProperty(i.fontFamily)?t[i.fontFamily]={...t[i.fontFamily],titleFontWeight:l,subTitleFontWeight:s,numberFontWeight:c,labelFontWeight:a}:t[i.fontFamily]={titleFontWeight:l,subTitleFontWeight:s,numberFontWeight:c,labelFontWeight:a}),n+=e.cssRender,r[e.id]={html:e.htmlRender,editorData:o,startTime:e.startTime,endTime:e.endTime}})),Object.keys(t).length){const e=Object.keys(t).map((e=>({font:e,weight:[...new Set([parseInt(t[e].titleFontWeight),parseInt(t[e].numberFontWeight),parseInt(t[e].subTitleFontWeight),parseInt(t[e].labelFontWeight)])].filter((e=>!isNaN(e)&&e>0)).sort((function(e,t){return e-t})).join(";")})));e.length&&window.STBASE.loadFont(e,"st-countdown-fonts")}n&&window.STBASE.addStyle(n)}(n),o&&o.map((n=>{const{imageUrl:o,countdownID:l,productHandle:a}=n;if(r.hasOwnProperty(l)){const{html:c,editorData:d,startTime:h,endTime:p}=r[l],g=c,m=e.createElement("div");if(m.innerHTML=g,"product-image"===d.displayPosition){m.classList.add("st-countdown-image");const n=String(o).match(i);if(Array.isArray(n)&&n.length){let o=n[0];if(o&&-1!==String(o).indexOf(".")&&(o=o.slice(0,String(o).lastIndexOf("."))),o)if(null!==t.theme){const n=t.theme.selectors.image;let o=[],i=[];if(n.map((e=>{const t=e.split("||");i.push(t[1]),o.includes(t[0])||o.push(t[0])})),o.map((t=>{let n=e.querySelectorAll(t);if(n.length)for(let e=0;e<n.length;e++){null!==n[e].querySelector(`a[href*="/products/${a}"]`)&&i.map((t=>{const o=n[e].querySelector(t);if(o&&!o.classList.contains(`item-${l}`)){const e=["absolute","fixed","sticky"],t=getComputedStyle(o);e.includes(t.position)||(o.style.position="relative"),o.appendChild(m),u(m,d,h,p),o.classList.add(`item-${l}`)}}))}})),s&&s===a){const n=t.theme.selectors.imageSingleProduct,o=e.querySelectorAll(n);if(o.length)for(let t=0;t<o.length;t++){const n=["absolute","fixed","sticky"],i=getComputedStyle(o[t]);n.includes(i.position)||(o[t].style.position="relative");const s=e.createElement("div");s.classList.add("st-single-count-down-image"),s.innerHTML=g,o[t].classList.contains(`item-${l}`)||(o[t].appendChild(s),u(s,d,h,p),o[t].classList.add(`item-${l}`))}}}else{const t=e.querySelectorAll('div[data-bg*="'+o+'"], div[data-bgset*="'+o+'"],img[src*="'+o+'"], img[srcset*="'+o+'"]');if(t.length)for(let e=0;e<t.length;e++){const n=t[e].parentNode,o=["absolute","fixed","sticky"],i=getComputedStyle(n);o.includes(i.position)||(n.style.position="relative"),n.classList.contains(`item-${l}`)||(n.appendChild(m),u(m,d,h,p),n.classList.add(`item-${l}`))}}}}else if("product-title"===d.displayPosition)if(m.classList.add("st-countdown-title"),null!==t.theme){const n=t.theme.selectors.detail.title;let o=[],i=[];if(n.map((e=>{const t=e.split("||");i.push(t[1]),o.includes(t[0])||o.push(t[0])})),o.map((t=>{let n=e.querySelectorAll(t);if(n.length)for(let e=0;e<n.length;e++){null!==n[e].querySelector(`a[href*="/products/${a}"]`)&&i.map((t=>{const o=n[e].querySelector(t);if(o){const e=o.parentNode,t=o.nextSibling;if(!e.classList.contains(`item-${l}`)){const n=m.cloneNode(!0);null===t?e.appendChild(n):e.insertBefore(n,t),u(n,d,h,p),e.classList.add(`item-${l}`)}}}))}})),s&&s===a){const n=t.theme.selectors.detail.titleSingleProduct,o=e.querySelectorAll(n);if(o.length)for(let t=0;t<o.length;t++){const n=["absolute","fixed","sticky"],i=getComputedStyle(o[t]);n.includes(i.position)||(o[t].style.position="relative");const s=e.createElement("div");s.classList.add("st-single-count-down-title"),s.innerHTML=g,o[t].classList.contains(`item-${l}`)||(o[t].appendChild(s),u(s,d,h,p),o[t].classList.add(`item-${l}`))}}}else{const t=n?.productTitle,o=function(t,n=null){const o=[],i=null===n?e:n;for(const e of i.querySelectorAll("div, h1, h2, h3, h4, h5, h6, h1 a, h2 a, h3 a, h4 a, h5 a, h6 a"))e.textContent.trim()===t&&0===e.children.length&&o.push(e);return o}(t);for(let e=0;e<o.length;e++){let t=o[e].parentNode;const n=o[e].nextSibling;if(!t.classList.contains(`item-${l}`)){const e=m.cloneNode(!0);null===n?t.appendChild(e):t.insertBefore(e,n),u(e,d,h,p),t.classList.add(`item-${l}`)}}}}}))}))}}async function d(){let o=window.STBASE.getTemplate(),i={shop:window.STBASE.getShopURL(),template:o};"collection"===o&&(i.collectionID=meta.page.resourceId?`gid://shopify/Collection/${meta.page.resourceId}`:"all"),"product"===o&&void 0!==typeof meta&&(i.productID=meta.product.gid),await fetch(window.STBASE.apiUrl+t,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((e=>e.json())).then((async({data:t})=>{const i=t.items,l=t?.css;if(t?.cssFixed&&(n=t?.cssFixed),i.length){let t="";const l={};if(i.map(((i,s)=>{const{countdownID:r,editorData:a,cssRender:c,htmlRender:d,startTime:h,endTime:p}=i,{displayPosition:g,fontFamily:m,titleFontWeight:f,subTitleFontWeight:S,numberFontWeight:y,displayProductPage:w,cssSelector:T}=a;t+=c,m?.fontFamily&&(l.hasOwnProperty(m.fontFamily)?l[m.fontFamily]={...l[m.fontFamily],titleFontWeight:f,subTitleFontWeight:S,numberFontWeight:y}:l[m.fontFamily]={titleFontWeight:f,subTitleFontWeight:S,numberFontWeight:y});const b=e.createElement("div");if(b.id=`st-countdown-wrapper-${r}`,b.innerHTML=d,"top-bar"===g){e.body.insertAdjacentElement("afterbegin",b);const t=b.querySelector(`[id="st-countdown-${r}"]`);null!==t&&(t.style.zIndex=25-s);const o=t.querySelector(".countdown-close");null!==o&&o.addEventListener("click",(function(e){window.STBASE.closeBar(e,".st-countdown-bar")}));const i=t.querySelector(".st-coupon-code");null!==i&&i.addEventListener("click",(function(e){window.STBASE.copy(e)})),window.STBASE.changeBodyStyle(".st-countdown-bar.countdown-topbar",n)}if("product-page"===g&&"product"===o){if("above_cart_button"===w){const t=`form[action*="/cart/add"]:not(.installment), form[action="/${window.STBASE.currentLanguage}/cart/add"]:not(.installment)`,n=e.querySelectorAll(t);if(n.length)for(let e=0;e<n.length;e++){n[e].parentNode.insertBefore(b,n[e])}}if("custom"===w&&T?.cssSelector){const t=e.querySelectorAll(T.cssSelector);if(null!==t)for(let e=0;e<t.length;e++){const n=t[e].parentNode;"above"===T?.cssPosition&&n.insertBefore(b,t[e]),"below"===T?.cssPosition&&n.insertBefore(b,t[e].nextSibling)}}}!function(e,t){const n=e.querySelector(".countdown-text-inner"),o=e.querySelector(".countdown-sub-text-inner"),i=e.querySelector(".countdown-action");null!==n&&t.messageText&&(n.innerHTML=window.STBASE.translate(t.messageText));null!==o&&t.messageSubText&&(o.innerHTML=window.STBASE.translate(t.messageSubText));null!==i&&t.buttonText&&(i.innerHTML=window.STBASE.translate(t.buttonText))}(b,a),u(b,a,h,p)})),Object.keys(l).length){const e=Object.keys(l).map((e=>({font:e,weight:[...new Set([parseInt(l[e].titleFontWeight),parseInt(l[e].numberFontWeight),parseInt(l[e].subTitleFontWeight),parseInt(l[e].labelFontWeight)])].filter((e=>!isNaN(e)&&e>0)).sort((function(e,t){return e-t})).join(";")})));e.length&&window.STBASE.loadFont(e,"st-countdown-fonts")}const s=e.getElementsByTagName("head")[0],r=e.createElement("style");r.id="st-countdown-css",r.setAttribute("type","text/css"),r.appendChild(e.createTextNode(t)),s.appendChild(r)}window.STBASE.addStyle(l)}))}function u(e,t,n,o){const{countdownType:i,fixedTime:l,timeZone:s,whenCountdownEnds:r}=t,a=new Date((new Date).toLocaleString("en-US",{timeZone:s}));if("right_now"===i||"definite_time"===i){const l=new Date(o);if("right_now"===i&&p(e,t,a,l),"definite_time"===i){const o=new Date(n);o.getTime()<l.getTime()&&p(e,t,o,l)}}if("fixed_time"===i){const n=parseInt(l),o=new Date(a.getTime()+6e4*n);p(e,t,a,o,n,r)}}function h(e){return String(e).padStart(2,"0").split("").map(((e,t)=>`<span class="num-split num-${t}">${e}</span>`)).join("")}function p(e,t,n,o,i,l="nothing"){const s=e.querySelector(".countdown-day"),r=e.querySelector(".countdown-hour"),a=e.querySelector(".countdown-minute"),c=e.querySelector(".countdown-seconds"),d=String(t.dayLabel).split("||"),u=String(t.hourLabel).split("||"),g=String(t.minuteLabel).split("||"),m=String(t.secondsLabel).split("||");STCountdown.timer(n,o,(function(e){s.querySelector(".value").innerHTML=h(e.days),0===e.days||e.days>=2?s.querySelector(".unit").innerHTML=d[0]:s.querySelector(".unit").innerHTML=2===d.length?d[1]:d[0],r.querySelector(".value").innerHTML=h(e.hours),0===e.hours||e.hours>=2?r.querySelector(".unit").innerHTML=u[0]:r.querySelector(".unit").innerHTML=2===u.length?u[1]:u[0],a.querySelector(".value").innerHTML=h(e.minutes),0===e.minutes||e.minutes>=2?a.querySelector(".unit").innerHTML=g[0]:a.querySelector(".unit").innerHTML=2===g.length?g[1]:g[0],c.querySelector(".value").innerHTML=h(e.seconds),0===e.seconds||e.seconds>=2?c.querySelector(".unit").innerHTML=m[0]:c.querySelector(".unit").innerHTML=2===m.length?m[1]:m[0]}),(function(){if(s.querySelector(".value").innerHTML="00",r.querySelector(".value").innerHTML="00",a.querySelector(".value").innerHTML="00",c.querySelector(".value").innerHTML="00",c.querySelector(".unit").innerHTML=2===m.length?m[1]:m[0],"hide_bar"===l&&(e.style.display="none"),i&&"repeat"===l){const n=new Date(o.getTime()+6e4*i);p(e,t,o,n,i,l)}}))}}(document);