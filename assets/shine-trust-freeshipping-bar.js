!function(e){var t="freeshipping-bar",n="";let o=setInterval((()=>{window.STBASE&&(window.STBASE.getShopURL()&&function(){if(""!==window.STBASE.getTemplate())s().then((e=>console.info("[ST] loaded Freeshipping bar"))),"undefined"!=typeof ST_FREESHIPPING_INTERVAL&&setInterval((()=>{a()}),ST_FREESHIPPING_INTERVAL);else{let e=setInterval((()=>{""!==window.STBASE.getTemplate()&&(s().then((e=>console.info("[ST] loaded Freeshipping bar"))),"undefined"!=typeof ST_FREESHIPPING_INTERVAL&&setInterval((()=>{a()}),ST_FREESHIPPING_INTERVAL),clearInterval(e))}),5)}}(),clearInterval(o))}),5);async function s(){let o=window.STBASE.getTemplate(),s=window.STBASE.apiUrl+t,a={shop:window.STBASE.getShopURL(),template:o};"collection"===o&&(a.collectionID=meta.page.resourceId?"gid://shopify/Collection/"+meta.page.resourceId:"all");const i=new URLSearchParams(window.location.search).get("utm_source");i&&(a.utmSource=i),await fetch(s,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>e.json())).then((async({data:t})=>{let o=[],s=t?.css,a=[];t?.cssFixed&&(n=t?.cssFixed);let i=0;await fetch(window.Shopify.routes.root+"cart.js").then((e=>e.json())).then((e=>{i=e?.total_price/100})),await Promise.all(t?.items.map((async(t,n)=>{let r=!0;if(t?.locationFilter&&!t?.locationShow.includes("all")&&""===window.STBASE.countryCustomer&&await fetch("https://ipinfo.io/json").then((e=>e.json())).then((e=>{window.STBASE.countryCustomer=e?.country.toLowerCase()})),"include"===t?.locationFilter?t?.locationShow.includes("all")||t?.locationShow.includes(window.STBASE.countryCustomer)||(r=!1):"exclude"===t?.locationFilter&&t?.locationShow.includes(window.STBASE.countryCustomer)&&(r=!1),r){""!==t?.font?.name&&o.push({font:t?.font?.name,weight:t?.font?.weight});const r=e.createElement("div");let l=window.STBASE.translate(t?.startText),d=window.STBASE.translate(t?.progressText),p=window.STBASE.translate(t?.successText),c=parseFloat(t?.money),w=t?.moneyFormat||"${{amount}}",S=l.replace("{{amount}}",`<span>${window.STBASE.formatMoney(c,w)}</span>`);i>0&&i<c?S=d.replace("{{amount}}",`<span>${window.STBASE.formatMoney(c-i,w)}</span>`):i>=c&&(S=p),r.innerHTML=t.html,r.classList.add("st-freeshipping-fadeIn"),r.getElementsByClassName("st-freeshipping-text")[0].innerHTML=S,r.getElementsByClassName("st-freeshipping-text")[0].setAttribute("data-settings",Base64.encode(JSON.stringify({startText:l,progressText:d,successText:p,money:c,moneyFormat:w}))),"desktop"===t?.deviceShow?(r.getElementsByClassName("st-freeshipping")[0].classList.add("hide-on-mobile"),r.getElementsByClassName("st-freeshipping")[0].classList.remove("hide-on-desktop")):"mobile"===t?.deviceShow?(r.getElementsByClassName("st-freeshipping")[0].classList.add("hide-on-desktop"),r.getElementsByClassName("st-freeshipping")[0].classList.remove("hide-on-mobile")):r.getElementsByClassName("st-freeshipping")[0].classList.remove("hide-on-mobile","hide-on-desktop"),r.getElementsByClassName("st-freeshipping")[0].style.zIndex=25-n,a.push({divBar:r,show:parseInt(t?.showAfter),hide:0!=t?.hideAfter?parseInt(t?.showAfter)+parseInt(t?.hideAfter):0}),s+=t.css}}))),a.map((t=>{setTimeout((()=>{e.body.insertAdjacentElement("afterbegin",t.divBar),window.STBASE.changeBodyStyle(".st-freeshipping",n)}),t.show),t.hide>0&&setTimeout((()=>{t.divBar.remove(),window.STBASE.changeBodyStyle(".st-freeshipping",n)}),t.hide)}));var r=e.getElementsByTagName("head")[0],l=e.createElement("style");l.setAttribute("type","text/css"),l.appendChild(e.createTextNode(s)),r.appendChild(l),window.STBASE.loadFont(o,"custom-google-font-freeshipping-bar")}))}async function a(){let t=e.querySelectorAll(".st-freeshipping-text");t.length&&await fetch(window.Shopify.routes.root+"cart.js").then((e=>e.json())).then((e=>{let n=e?.total_price/100;for(let e=0;e<t.length;e++){const o=t[e];let s=JSON.parse(Base64.decode(o.getAttribute("data-settings"))),a=s?.startText||"",i=s?.progressText||"",r=s?.successText||"",l=parseFloat(s?.money||0),d=s?.moneyFormat||"${{amount}}",p=a.replace("{{amount}}",`<span>${window.STBASE.formatMoney(l,d)}</span>`);n>0&&n<l?p=i.replace("{{amount}}",`<span>${window.STBASE.formatMoney(l-n,d)}</span>`):n>=l&&(p=r),o.innerHTML=p}}))}window.addEventListener("ST:add",(e=>{console.log("ST add"),a()})),window.addEventListener("ST:update",(e=>{a()})),window.addEventListener("ST:change",(e=>{a()})),window.addEventListener("ST:clear",(e=>{a()})),window.addEventListener("ST:mutate",(e=>{a()})),window.stCloseBar=function(e){window.STBASE.paddingTop=0,window.STBASE.paddingBottom=0;let t=".st-topbar",n=e.target.closest(t);null===n&&(t=".st-freeshipping",n=e.target.closest(t)),n&&(n.style.maxHeight=0,n.style.padding="0px",setTimeout((()=>{n.remove(),window.STBASE.changeBodyStyle(t)}),300))}}(document);