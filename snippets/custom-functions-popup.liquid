<style>
                                 .parent-div{
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                  }
                                  .child-div{

                                    padding-top: 1em;
                                    padding-bottom: 4em;
                                    padding-left: 1.5em;
                                      padding-right: 1.5em;
                        /*             height: 50rem; */
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                    flex-direction: column;
                                    background: white;
                                    margin: 1em;
                                  }
                                  .top-div{
                                    display: flex;
                                    flex-direction: column;
                                    justify-content: center;
                                    align-items: center;
                                    flex-direction: column;
                                    text-align: center;
                                    position: relative;
                                  }
                                    .popuplogo {
                                  height: 5rem;
                                  width: 9rem;
                                      margin-bottom: 1em;
                                }
                                  .head-one{
                                     font-size: 2.0rem;
                                    font-weight: 900;
                                    color: black;
                                  }
                                  .head-two{
                                    font-size: 2.2rem;
                                    font-weight: 900;
                                    color: #62ab00;
                                  }
                                          #dn-tagline{

                        display: none;

                                          }



      /*                             .head-three{
                                    color: black;
                                    margin-left: 0.4rem;
                                  } */
                                  .para{
    /*                                 opacity: .5; */
                                  }
                                  .middle-div{
                                    display: grid;
                            /*         justify-content: center; */
                              /*       alig-items: center; */
                              /*       flex-direction: column; */
        /*                             margin-top: 5rem; */
                              /*       width: 60%; */

                                  }


                               .closeicon{
                                  display: flex;
            justify-content: flex-end;
            align-items: flex-start;
            width: 100%;
            margin-bottom: 1em;
                                     opacity: 0.2;
                               }
                                 .number-field {
                                  color: black;
                                  display: flex;
                                  justify-content: center;
                                  align-items: center;
                                  margin: auto ;
                                  border: none;
                                  border-bottom: 2px solid black;
                                  width: 22rem;
                                  text-align: center;
                                  padding: 1.1rem;
                                  font-size: 2.0rem;
                                  font-weight: bold;
                                  letter-spacing: 2px;
                                }
                                  .otp-btn{
                                    margin: 0 auto;
                                    width: 20rem;
                                    height: 5rem;
                                    color: white;
                                    font-weight: 900;
                                    background-color: #62ab00;
                /*                     border: 1px solid black; */
                                    border-radius: 5rem;
                                    opacity: 0.5;
                                  }
                                  .last-div{
                                    margin-top: 5rem;
                                    display: flex;
                                    justify-content: center;
                                    align-item: center;
                                    flex-direction: column;
                                    text-align: center;
                                    z-index: -5;
                                    transform: translateX(-120rem);
                                  }
                                  .otp-parent{
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                    gap: 2rem;
                                    margin: 2rem;
                                  }
                                  .phone-number{
                                    font-size: 1.6rem;
                                     opacity: .5;
                                  }
                                  .otp{
                                    background: none !important;
                                    border: none;
                                    border-bottom: 2px solid gray;
                                    width: 5rem;
                                    height: 5rem;

                                    text-align: center;
                                  }
                                 input:focus {
            border-bottom: 2px solid #62ab00;
            outline: none;
          }
                                  .otp{
                                     color: #62ab00;
                                    font-size: 3.5rem;
                                  }
                                  input::-webkit-outer-spin-button,
                                  input::-webkit-inner-spin-button {
                                  -webkit-appearance: none;
                                    margin: 0;
                                  }
                                  .download-btn{
            /*                         margin-top: 4rem; */

                                     margin: 0 auto;
                                    width: 20rem;
                                    height: 5rem;
                                    color: white;
                                    font-weight: 900;
                                    background-color: black;
                /*                     border: 1px solid black; */
                                    border-radius: 5rem;
                                    opacity: 0.5;
                                  }
                                  .resend-para{
                                    margin-top: 3rem;
                                    font-size: 1.3rem;
                                     opacity: .8;
                                    font-weight: 900;
                                  }
                                  .resend-otp{
                                    color: #62ab00;
                                    margin-left: 4px;
                                  }
  /*                                 .cross{
                                    position: absolute;
                                    top: -6rem;
                                    right: 2rem;
                                    font-size: 3rem;
                                    color: black;
                                    font-weight: normal;
                                    cursor: pointer;
                                    z-index: 1000;
                                  } */
                                  .animate-one{
                                    z-index: -5;
                                    display: none;
                                    transition: all .5s;
                                  }
                                  .animate-two{
                                    display: block !important;
                                    transform: translate(0);
                                    transition: all .1s;
                                    z-index: 5;
                                    animation-name: swap;
                                    animation-duration: 2s;

                                    .child-div{
                                        height: 60rem;

                      /*                 background-color: red; */
                                    }
                                  }
                                        .wrong-otp-error{
                                          color: red;
                                          display: none;
                                        }

                          .resend-otp-message{
                           color: green;
                                          display: none;

                          }
                                  .child-div-increase{
                          /*           height: 60rem; */
                                  }

                                  @keyframes swap{
                                    10%{
                                      visibility: hidden;
                                    }

                                    80%{
                                      visibility: visible;
                                    }
                                    100%{
                                      visibility: visible;
                                    }
                                  }
                                @media screen and (max-width: 500px){
                    /*               #mod{
                                    margin-top: -12rem !important;
                                  } */
                                  .child-div{
                          /*           height: 45rem; */
                                    width: 35rem;
                                      padding: 2rem;
                                    padding-bottom: 3em;
                                  }
                                  .closeicon{
                                       margin: 0em;

                                  }
                                  .head-two{
                                    font-size: 2rem;
                                  }
                                  .otp-btn{
                                    width: 15rem;
                                    margin-top: 0;
                                  }
                                  .number-field{
                                    width: 20rem;
                                  }
                                  .last-div{
                                    margin-top:2rem;
                                  }
  /*                                 .cross{
                                    top: -1rem;
                                    right: 0;
                                  } */
                                     .otp-parent{
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                    gap: 1.5rem;
                                  }

                                   .otp{
                                    background: none !important;
                                    border: none;
                                    border-bottom: 2px solid black;
                                    width: 3.5rem;
                                    height: 3.5rem;
                                    text-align: center;
                                  }
                                  .otp{
                                    font-size: 2.5rem;
                                  }
                                }
</style>

<script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  if(localStorage.getItem("globalOtpKey") == null){

  if(sessionStorage.getItem('NewsLetterIsClosed')== null){

      document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      openNewsletter() ; // Replace '#myModal' with the actual ID of your modal
    }, 1000);
  });
  }


    

  
  }

 let cartViewkey = true;
 
  function openCloseCartSlider()
    {
             switch(cartViewkey){
               case true: {

                        openCartView();
                 cartViewkey = false;
                 break;
               }

               case false: {

closeCartView()
                           cartViewkey = true;
                  break;
               }
             }
              
      
    }
  
    function openCartView() {
          document.getElementById("cartslider").style.width = "80%";
        }

 function closeCartView() {
          document.getElementById("cartslider").style.width = "0";
        }
  
  
 ////////////// event listenerssssssss
 const login =  document.getElementById("login")

  // const buyNow =  document.getElementById("login")
  // const getPdf =  document.getElementById("login")


  ////login
//   login.addEventListener("click", function() {
//    funKey = '#LoginPopUp';
//    // showPopup('#cart-view-slider')
//      openCartView()
// });

  
  /////add to cart 



//   document.addEventListener("DOMContentLoaded", function() {
  
//   let atc =  document.getElementById("cpAddToCart")


// if (atc != null) {
//  atc.addEventListener("click", function() {
    
//     showAddtoCartPopup('#AddToCartPopUp')

// });
  
// }




    
// });

   
  
  
  ///////////////
  

  

  // JavaScript code goes here
  
  let smsotp = '';
  let getButton ="";
let clearKey = false;

  let funKey ='';
 
  let mobNumber = "";

function validateLength(buttonShowAndHide, getlength) {
    
  const myInput = document.querySelector(getlength);
  if (myInput.value.length == 10) {
    document.getElementById(buttonShowAndHide).disabled = false;
    document.getElementById(buttonShowAndHide).style.opacity = "1";
  } else {
    document.getElementById(buttonShowAndHide).disabled = true;
    document.getElementById(buttonShowAndHide).style.opacity = "0.5";
  }
}


  function onlyNum(numId) {

    input= document.getElementById(numId);

      const value = input.value;
      const cleanedValue = value.replace(/\D/g, ""); // Remove non-numeric characters
      input.value = cleanedValue;

  }



  
function randomOtp(){

    smsotp = Math.floor(100000 + Math.random() * 900000);
    console.log(smsotp);
  
};

let wrongOtpId ='';
  let sendOtpId='';

function sendOtp(phoneNumberId, showPhoneNumberAsTextId, middlediv, lastdiv, childdiv, wrongPTagID, sendPTagId, dnPdf, dntagline) {
  
  randomOtp();
  mobNumber = document.getElementById(phoneNumberId).value;

 wrongOtpId = wrongPTagID;
 sendOtpId= sendPTagId;

  console.log(dnPdf);
  if(dnPdf != 'none'){
      document.getElementById(dnPdf).style.display = "none";
  document.getElementById(dntagline).style.display = 'block';
  }

  document.getElementById(middlediv).classList.add("animate-one");
  document.getElementById(lastdiv).classList.add("animate-two");
  document.getElementById(childdiv).classList.add("child-div-increase");
  document.getElementById(showPhoneNumberAsTextId).innerHTML = mobNumber;
  navigator.sendBeacon(`https://bhartipur.in/send_otp_get/${mobNumber}/${smsotp}`)
  
}

function showPopup(popupId){
  
  $(popupId).modal('show');
  
}
  
function hidePopup(popupId){


  $(popupId).modal('hide');
  
}



  let otpClean1 = '';
  let otpClean2 = '';
  let otpClean3 = '';
  let otpClean4 = '';
  let otpClean5 = '';
  let otpClean6 = '';


function clearOtpInputForm(){

  if (clearKey == true){
   otpClean1.value = '';
   otpClean2.value = '';
   otpClean3.value = '';
   otpClean4.value = '';
   otpClean5.value = '';
    otpClean6.value = '';


  otpClean2.setAttribute("disabled", true);
  otpClean3.setAttribute("disabled", true);
  otpClean4.setAttribute("disabled", true);
  otpClean5.setAttribute("disabled", true);
  otpClean6.setAttribute("disabled", true);
  }
  
}

  
 function verifyOtp (popupId, otp1, otp2, otp3, otp4, otp5, otp6) {
clearKey = true;
   document.getElementById(sendOtpId).style.display = "none";
otpClean1 = document.getElementById(otp1);
  otpClean2 = document.getElementById(otp2);
   otpClean3 = document.getElementById(otp3);
   otpClean4 = document.getElementById(otp4);
   otpClean5 = document.getElementById(otp5);
   otpClean6 = document.getElementById(otp6);
   
  let otpInput1 = document.getElementById(otp1).value;
  let otpInput2 = document.getElementById(otp2).value;
  let otpInput3 = document.getElementById(otp3).value;
  let otpInput4 = document.getElementById(otp4).value;
  let otpInput5 = document.getElementById(otp5).value;
  let otpInput6 = document.getElementById(otp6).value;
  let finalOtp = otpInput1.toString() + otpInput2.toString() + otpInput3.toString() + otpInput4.toString() + otpInput5.toString() + otpInput6.toString();
  let parseOtp = parseInt(finalOtp);
  if (parseOtp == smsotp) {
    localStorage.setItem("globalOtpKey", mobNumber);
 

    


switch (funKey) {
  case "#LoginPopUp": {
      hidePopup(popupId);
      window.location.reload();
      break;
      
    }
    
   case "#buyNowPopUp": {

 const element = document.querySelector("#button-cart-buy");

      // Create a new click event
      const clickEvent = new MouseEvent("click", {
        bubbles: true,
        cancelable: true,
        view: window
      });
      
      // Dispatch the click event on the element
      element.dispatchEvent(clickEvent);
       element.dispatchEvent(clickEvent);
    break;
      
    }
     
  case "#AddToCartPopUp": {
   
  // processAddtoCartPopup(getButton);
    hidePopup(popupId);


   break;
    
  }  
  case "#getPdfPopUp": {
 hidePopup(popupId);
processPdflink(getButton);
       break;
  }

  case "#openBlogPopUp": {
 hidePopup(popupId);
processBlogLink(getButton);
       break;
  }

    



  case '#viewCart': {
console.log('/cart')
      location.href = '/cart'
break;
    
  }
     case '#checkOut': {

console.log('/co')
   location.href = '/checkout'
       break;
  }
    
 default:
     hidePopup(popupId);
   
  }  
    
  } else {

     document.getElementById(wrongOtpId).style.display = "block";
  
  }
};
////////////////////////////////////////////////////////////////
///////functions 
  ////////


  
function viewCart(){

  funKey= '#viewCart';

 // location.href = '/cart'
  
   if(localStorage.getItem("globalOtpKey")== null){
                                showPopup('#LoginPopUp');
                              
                            }else {
                                          location.href = '/cart'
                            }
  
}

function checkOut(){

  funKey= '#checkOut';

// location.href = '/checkout'
  
   if(localStorage.getItem("globalOtpKey")== null){
                                showPopup('#LoginPopUp');
                              
                            }else {

                                  location.href = '/checkout'
                            }
  
}

  
function resendOtpSms(){
  document.getElementById(wrongOtpId).style.display = "none";
   document.getElementById(sendOtpId).style.display = "block";
console.log(mobNumber)
  console.log(smsotp)
   randomOtp();
    clearOtpInputForm();
 navigator.sendBeacon(`https://bhartipur.in:5000/send_otp_get/${mobNumber}/${smsotp}`)
}
  
function processUserLogin(){

   funKey = '#LoginPopUp';
  showPopup('#LoginPopUp');

  
}

        function processAddtoCartPopup(ref){
 getButton =ref;
           funKey= '#AddToCartPopUp';
   let productID = ref.getAttribute('data-product-id')
                 let productAvailable = ref.getAttribute('data-product-available')
            let productPage = ref.getAttribute('data-product-page')
                  

      if(  ref.id !='button-cart'  )
      {
  if (productAvailable){

                   cart.add(productID)
             
           } else {

              location.href = productPage
            
           }
        
      }
          
           // let productID = ref.getAttribute('data-product-id')
           //       let productAvailable = ref.getAttribute('data-product-available')
           //  let productPage = ref.getAttribute('data-product-page')
           //         console.log(productPage);
           // if (productAvailable){

           //         cart.add(productID)
             
           // } else {

           //    location.href = productPage
            
           // }
  
                      
                            if(localStorage.getItem("globalOtpKey")== null){
                                showPopup('#LoginPopUp');
                              
                            }else {

                              userInteraction(ref);
                            }
        }


 function processCollectionBuyNowPopup(ref){
 getButton =ref;
         
   let productID = ref.getAttribute('data-product-id')
                 let productAvailable = ref.getAttribute('data-product-available')
            let productPage = ref.getAttribute('data-product-page')
                  

    
  if (productAvailable){

                   cart.add(productID)
             
           } else {

              location.href = productPage
            
           }
        
    
          
           
             location.href = '/checkout'
            
           

                      
                            
        }

  
 function processPdflink(ref){
 let pdfLink =  ref.getAttribute('data-pdflink')   
   let id = ref.getAttribute('id')
    funKey= '#getPdfPopUp';
          getButton = ref;
   
   if(localStorage.getItem("globalOtpKey")== null){
                     showPopup('#getPdfPopUp');
    

// if(id == "openPdfFile") {
//   openProductPdf();
// }else{
//    window.open(`${pdfLink}`, "_blank")
// }


     
   }else{



if(id == "openPdfFile") {
  console.log(id)
  openProductPdf();
}else{
  userInteraction(ref)
   console.log(ref)
   window.open(`${pdfLink}`, "_blank")
  
}


     
   }

   
 }

function processBlogLink(ref) {
  console.log(ref)
  getButton = ref;
 funKey= '#openBlogPopUp';
 let blogUrl = ref.getAttribute('data-bloglink');

console.log(blogUrl);
  
  if(localStorage.getItem("globalOtpKey")== null) {
showPopup('#LoginPopUp');


    
  }else {
     
    if (blogUrl != null)
 {
   window.open(`${blogUrl}`, "_blank");
 }
   
    userInteraction(ref);
  }

  
    
}


function processBuyNow(ref) {
  console.log(ref)
  getButton = ref;
 
funKey= '#buyNowPopUp';
  
  if(localStorage.getItem("globalOtpKey")== null) {
showPopup('#LoginPopUp');


    
  }else {
     
    const element = document.querySelector("#button-cart-buy");

      // Create a new click event
      const clickEvent = new MouseEvent("click", {
        bubbles: true,
        cancelable: true,
        view: window
      });
      
      // Dispatch the click event on the element
      element.dispatchEvent(clickEvent);
       element.dispatchEvent(clickEvent);
    
}

}



// function userInteraction(ref){

//             let productID = ref.getAttribute('data-product-id')
//                let buttonID = ref.getAttribute('id')
//             let productPage = ref.getAttribute('data-product-page')
// let mobnum= localStorage.getItem("globalOtpKey");
//    var data = {
//    phone_number: mobnum,
//    button_id: buttonID,
//    item_id: productID,
//    url: productPage
// };

//   fetch('https://bhartipur.in/register_event', {
//    method: 'POST',
//    headers: {
//        'Content-Type': 'application/json'
//    },
//    body: JSON.stringify(data)
// });

// }



function userInteraction(ref) {
  console.log(ref);
    let productID = ref.getAttribute('data-product-id');
    let buttonID = ref.getAttribute('id');
    let productPage = ref.getAttribute('data-product-page');
     let mobnum ;
if(localStorage.getItem("globalOtpKey") != null) {
  
    mobnum = localStorage.getItem("globalOtpKey");
}else if(localStorage.getItem("logOutOtpKey") != null){
         
    mobnum = localStorage.getItem("logOutOtpKey");
} else {
mobnum ='1234567890'
  
}

  
    var data = {
        phone_number: mobnum,
        button_id: buttonID,
        item_id: productID,
        url: productPage
    };
 console.log(data);
    fetch('https://bhartipur.in/register_event', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        // Handle the response data here (if needed)
        console.log('Response data:', data);
    })
    .catch(error => {
        // Handle any errors that occurred during the fetch or response processing
        console.error('Error:', error);
    });
}



















































































































</script>
