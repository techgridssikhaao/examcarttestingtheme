<style>
    .animate-one {
    z-index: -5;
    display: none;
    transition: all .5s;
  }

  .animate-two {
    display: block !important;
    transform: translate(0);
    transition: all .1s;
    z-index: 5;
    animation-name: swap;
    animation-duration: 2s;
  }

  .child-div-increase {
    height: 60rem;
  }
</style>

<script>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 ////////////// event listenerssssssss
 const login =  document.getElementById("login")
  const atc =  document.getElementById("cpAddToCart")
  const buyNow =  document.getElementById("login")
  const getPdf =  document.getElementById("login")


  //////login
  login.addEventListener("click", function() {

    showPopup('#LoginPopUp')

});

  
  /////add to cart 


atc.addEventListener("click", function() {
console.log("atc");
    showAddtoCartPopup('#AddToCartPopUp')

});

  
  
  ///////////////
  

  

  // JavaScript code goes here
  
  let smsotp = '';


 
  let mobNumber = "";

function validateLength(buttonShowAndHide, getlength) {
  const myInput = document.querySelector(getlength);
  if (myInput.value.length == 10) {
    document.getElementById(ref).disabled = false;
    document.getElementById(ref).style.opacity = "1";
  } else {
    document.getElementById(ref).disabled = true;
    document.getElementById(ref).style.opacity = "0.5";
  }
}

function randomOtp(){

    smsotp = Math.floor(100000 + Math.random() * 900000);
    console.log(smsotp);
  
};



function sendOtp(phoneNumberId, showPhoneNumberAsTextId, middlediv, lastdiv, childdiv) {
  
  randomOtp();
  mobNumber = document.getElementById(phoneNumberId).value;


  
  document.getElementById(middlediv).classList.add("animate-one");
  document.getElementById(lastdiv).classList.add("animate-two");
  document.getElementById(childdiv).classList.add("child-div-increase");
  document.getElementById(showPhoneNumberAsTextId).innerHTML = mobNumber;
  navigator.sendBeacon(`https://bhartipur.in:5000/send_otp_get/${mobNumber}/${smsotp}`)
  
}

function showPopup(popupId){
  console.log(popupId)
  $(popupId).modal('show');
  
}
  
function hidePopup(popupId){


  $(popupId).modal('hide');
  
}


 function verifyOtp (popupId) {


    
  let otpInput1 = document.getElementById("otp1-buy").value;
  let otpInput2 = document.getElementById("otp2-buy").value;
  let otpInput3 = document.getElementById("otp3-buy").value;
  let otpInput4 = document.getElementById("otp4-buy").value;
  let otpInput5 = document.getElementById("otp5-buy").value;
  let otpInput6 = document.getElementById("otp6-buy").value;
  let finalOtp = otpInput1.toString() + otpInput2.toString() + otpInput3.toString() + otpInput4.toString() + otpInput5.toString() + otpInput6.toString();
  let parseOtp = parseInt(finalOtp);
  if (parseOtp == smsotp) {
    localStorage.setItem("globalOtpKey", phoneNumber);
 

    


switch (popupId) {
  case "#LoginPopUp": {
      hidePopup(popupId);
      window.location.reload();
      break;
      
    }
    
   case "#BuyNow": {

 const element = document.querySelector("#button-cart-buy");

      // Create a new click event
      const clickEvent = new MouseEvent("click", {
        bubbles: true,
        cancelable: true,
        view: window
      });
      
      // Dispatch the click event on the element
      element.dispatchEvent(clickEvent);
       element.dispatchEvent(clickEvent);
    break;
      
    }
     
  case "#AddToCartPopUp": {
 
    
    hidePopup(popupId);


   break;
    
  }  

    
    default:
     hidePopup(popupId);
}

   
       
    
  } else {
    alert("fail");
  }
};



        function showAddtoCartPopup(popupId){


          
                            if(localStorage.getItem("globalOtpKey")== null){
                                showPopup(popupId);
                              
                                  {% if product.variants.first.available %}cart.add('{{  product.variants.first.id  }}'){% else %}location.href='{{product.url}}'{% endif %};

                             

                              
                            }else {

                                {% if product.variants.first.available %}cart.add('{{  product.variants.first.id  }}'){% else %}location.href='{{product.url}}'{% endif %};
                            }
          
        }


  
// const inputsBuy = document.querySelectorAll(".otp-form"),
  
//  const buttonBuy = document.querySelector("#otp-btn-buy");

// inputsBuy.forEach((input, index1) => {
//   input.addEventListener("keyup", (e) => {
//     const currentInput = input,
//       nextInput = input.nextElementSibling,
//       prevInput = input.previousElementSibling;
//     if (currentInput.value.length > 1) {
//       currentInput.value = "";
//       return;
//     }
//     if (nextInput && nextInput.hasAttribute("disabled") && currentInput.value !== "") {
//       nextInput.removeAttribute("disabled");
//       nextInput.focus();
//     }
//     if (e.key === "Backspace") {
//       inputsBuy.forEach((input, index2) => {
//         if (index1 <= index2 && prevInput) {
//           input.setAttribute("disabled", true);
//           input.value = "";
//           prevInput.focus();
//         }
//       });
//     }
//     if (!inputsBuy[3].disabled && inputsBuy[3].value !== "") {
//       buttonBuy.classList.add("active");
//       return;
//     }
//     buttonBuy.classList.remove("active");
//   });
// });

// window.addEventListener("load", () => inputsBuy[0].focus());

/////////////////////////////////////////////////////////////////////////////////////////


  
// openModalBuy = () => {
//   document.getElementById("otp-form-buy").style.display = "block";
// };

// clearAllFormBuy = () => {
//   let otpInput1 = document.getElementById("otp1-buy");
//   let otpInput2 = document.getElementById("otp2-buy");
//   let otpInput3 = document.getElementById("otp3-buy");
//   let otpInput4 = document.getElementById("otp4-buy");
//   let otpInput5 = document.getElementById("otp5-buy");
//   let otpInput6 = document.getElementById("otp6-buy");

//   otpInput1.value = "";
//   otpInput2.value = "";
//   otpInput3.value = "";
//   otpInput4.value = "";
//   otpInput5.value = "";
//   otpInput6.value = "";

//   lastDivBuy.classList.remove("animate-two");
//   middleDivBuy.classList.remove("animate-one");
//   document.getElementById("number-buy").value = "";
//   let mainClass = document.querySelector(".modal-backdrop");
//   mainClass.style.display = "none";
//   document.getElementById("LoginPopUp").style.display = "none";
  
// };




















































</script>
