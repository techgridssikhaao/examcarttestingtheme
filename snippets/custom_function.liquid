<script>
  
  
  let serverOtp = '';
  

  // JavaScript code goes here




function validateLength(ref) {
  const myInput = document.querySelector("#number-buy");
  if (myInput.value.length == 10) {
    document.getElementById(ref).disabled = false;
    document.getElementById(ref).style.opacity = "1";
  } else {
    document.getElementById(ref).disabled = true;
    document.getElementById(ref).style.opacity = "0.5";
  }
}





  
let serverOtp = '';

  
otpMakerBuy = () => {
  serverOtpBuy = Math.floor(Math.random() * 900000 + 100000);
  console.log(serverOtpBuy);
};



let getResponseBuy = {};
let middleDivBuy = document.getElementById("middle-div-buy");
let lastDivBuy = document.getElementById("last-div-buy");
let childdivBuy = document.getElementById("child-div-buy");

let phoneNumberBuy = "";

function otpSendBuy() {
  otpMakerBuy();
  phoneNumberBuy = document.getElementById("number-buy").value;
  middleDivBuy.classList.add("animate-one");
  lastDivBuy.classList.add("animate-two");
  childdivBuy.classList.add("child-div-increase");
  document.getElementById("phone-number-buy").innerHTML = phoneNumberBuy;
  navigator.sendBeacon(`https://bhartipur.in:5000/send_otp_get/${phoneNumberBuy}/${serverOtpBuy}`)
}




async function funBuy() {
  navigator.sendBeacon(`https://bhartipur.in:5000/send_otp_get/${phoneNumberBuy}/${serverOtpBuy}`)

  {% comment %} let url = `https://bhartipur.in:5000/send_otp_get/${phoneNumberBuy}/${serverOtpBuy}`;
  fetch(url)
    .then((response) => {
      if (!response.ok) {
        throw new Error("Network response was not ok");
      }
    })
    .then((data) => {
      console.log(data);
    })
    .catch((error) => {
      console.error("Error:", error);
    }); {% endcomment %}
}

const inputsBuy = document.querySelectorAll(".otp-form"),
  buttonBuy = document.querySelector("#otp-btn-buy");

inputsBuy.forEach((input, index1) => {
  input.addEventListener("keyup", (e) => {
    const currentInput = input,
      nextInput = input.nextElementSibling,
      prevInput = input.previousElementSibling;
    if (currentInput.value.length > 1) {
      currentInput.value = "";
      return;
    }
    if (nextInput && nextInput.hasAttribute("disabled") && currentInput.value !== "") {
      nextInput.removeAttribute("disabled");
      nextInput.focus();
    }
    if (e.key === "Backspace") {
      inputsBuy.forEach((input, index2) => {
        if (index1 <= index2 && prevInput) {
          input.setAttribute("disabled", true);
          input.value = "";
          prevInput.focus();
        }
      });
    }
    if (!inputsBuy[3].disabled && inputsBuy[3].value !== "") {
      buttonBuy.classList.add("active");
      return;
    }
    buttonBuy.classList.remove("active");
  });
});

window.addEventListener("load", () => inputsBuy[0].focus());

downloadBtnBuy = () => {
  let otpInput1 = document.getElementById("otp1-buy").value;
  let otpInput2 = document.getElementById("otp2-buy").value;
  let otpInput3 = document.getElementById("otp3-buy").value;
  let otpInput4 = document.getElementById("otp4-buy").value;
  let otpInput5 = document.getElementById("otp5-buy").value;
  let otpInput6 = document.getElementById("otp6-buy").value;
  let finalOtp = otpInput1.toString() + otpInput2.toString() + otpInput3.toString() + otpInput4.toString() + otpInput5.toString() + otpInput6.toString();
  let parseOtp = parseInt(finalOtp);
  if (parseOtp == serverOtpBuy) {
    localStorage.setItem("globalOtpKey", phoneNumberBuy);
    // clearAllFormBuy();
  document.getElementById("LoginPopUp").style.display = "none";
 window.location.reload();

    
  } else {
    alert("fail");
  }
};


  function loginPopUp(){
  $("#LoginPopUp").modal('show');
   }
  
openModalBuy = () => {
  document.getElementById("otp-form-buy").style.display = "block";
};

clearAllFormBuy = () => {
  let otpInput1 = document.getElementById("otp1-buy");
  let otpInput2 = document.getElementById("otp2-buy");
  let otpInput3 = document.getElementById("otp3-buy");
  let otpInput4 = document.getElementById("otp4-buy");
  let otpInput5 = document.getElementById("otp5-buy");
  let otpInput6 = document.getElementById("otp6-buy");

  otpInput1.value = "";
  otpInput2.value = "";
  otpInput3.value = "";
  otpInput4.value = "";
  otpInput5.value = "";
  otpInput6.value = "";

  lastDivBuy.classList.remove("animate-two");
  middleDivBuy.classList.remove("animate-one");
  document.getElementById("number-buy").value = "";
  let mainClass = document.querySelector(".modal-backdrop");
  mainClass.style.display = "none";
  document.getElementById("LoginPopUp").style.display = "none";
};











</script>
