{% assign product_collection = section.settings.collection %}
<style>
  /* .owl-item{
    width:20% !important;
  } */

  .owl-stage{
    /* transform: none !important;
    transition: none !improtant; */
  }
</style>



<div class="tt_tabsproduct_module tabs-category-slider list-module {% if section.settings.listing_rows != 1 %} multi-rows {% endif %}" id="product_module{{section.id}}">
  <div class="module-title">
    {% if section.settings.heading != blank %}  
    <h2>{{ section.settings.heading }}</h2>
    {% endif %}
    <div class="box-tab">
      <ul class="tab-heading tabs-categorys">
        <li>
          <a data-toggle="pill" href="#tab-{{section.id}}0">
            <span>{{ section.settings.heading }}</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="clearfix"></div>
  </div>
  <div class="box-style">
    <div class="owl-container">
      <div class="tt-product ">
        <div class="tab-content">
          <div class="tab-container-{{section.id}}  owl-carousel owl-theme owl-carousel-1 tab-pane tab-product-container  fade " id="tab-{{section.id}}0">
            {% if section.settings.listing_rows == 1 %}
            {% for product in collections[product_collection].products limit:section.settings.products_tab_count %}
            <div class="row_items {% cycle 'odd','even' %}">
              {% include 'product-grid-item-list' %}
            </div>
            {% endfor %}
            {% else %}
            <div class="row_items {% cycle 'odd','even' %}">
              {% for product in collections[product_collection].products limit:section.settings.products_tab_count %}
              {% include 'product-grid-item-list' %}
              {% if forloop.last == false %}
              {% cycle '','</div><div class="row_items">' %}
              {% endif %}
              {% endfor %}
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="clearfix"></div>
</div>
<script >
  $(document).ready(function() {
    $('a[href="#tab-{{section.id}}0"]').trigger( "click" );
      $(".tab-container-{{section.id}}").owlCarousel({
      items: {{ section.settings.no_of_products }},
      loop:  false ,
      margin:  0 ,
      nav:  false ,
      dots:  true ,
      autoplay:   false ,
      autoplayTimeout:  1000 ,
      autoplayHoverPause: true,
      autoplaySpeed:  1000 ,
      navSpeed:  1000 ,
      dotsSpeed:  1000 ,
      lazyLoad: true,
      responsive:{
      0:{
      items: 1,
      nav: true
      },
      480:{
      items: 3,
      nav: true
      },
      768:{
      items: 2
      },
      992:{
      items: 2
      },
      1200:{
      items: {{ section.settings.no_of_products }}
      },
      1600:{
      items: {{ section.settings.no_of_products }}
      }
      },
      onInitialized: function() {
      var count = $(".tab-container-{{section.id}} .owl-item.active").length;
                    if(count == 1) {
        $(".tab-container-{{section.id}} .owl-item").removeClass('first');
          $(".tab-container-{{section.id}} .owl-item.active").addClass('first');
          } else {
          $(".tab-container-{{section.id}} .owl-item").removeClass('first');
          $(".tab-container-{{section.id}} .owl-item.active:first").addClass('first');
          }
          },
          onTranslated: function() {
          var count = $(".tab-container-{{section.id}} .owl-item.active").length;
                        if(count == 1) {
            $(".tab-container-{{section.id}} .owl-item").removeClass('first');
              $(".tab-container-{{section.id}} .owl-item.active").addClass('first');
              } else {
              $(".tab-container-{{section.id}} .owl-item").removeClass('first');
              $(".tab-container-{{section.id}} .owl-item.active:first").addClass('first');
              }
              }
              });
          });
</script>

<!-- <script>
    document.addEventListener('DOMContentLoaded', function() {
     $(document).ready(function() {
    $('a[href="#tab-{{section.id}}0"]').trigger( "click" );
      $(".tab-container-{{section.id}}").owlCarousel({
        items: {{ section.settings.no_of_products }},
        loop: true,
        margin: 10,
        nav: true,
        responsive: {
          0: { items: 1 },
          600: { items: 3 },
          1000: { items: 5 }
        }
      });

      let isDragging = false;
      let startX = 0;
      let currentTranslate = 0;
      let prevTranslate = 0;

  // const containerWidth = carousel.width();
      // console.log(carousel.width())
      // console.log(carousel.length)
      // const carouselContainer = carousel.find('.owl-stage');

      function handleDragStart(e) {
        isDragging = true;
        startX = e.clientX || e.touches[0].clientX;
        prevTranslate = currentTranslate;
        carousel.css('transition', 'none'); // Disable transitions while dragging
      }

      function handleDragMove(e) {
        if (!isDragging) return;
        const moveX = (e.clientX || e.touches[0].clientX) - startX;
         const carouselWidth = carousel.width();
        const itemsWidth = carousel.find('.owl-item').width() * carousel.find('.owl-item').length;
        const minTranslate = carouselWidth - itemsWidth;
        const maxTranslate = 0;
        
        currentTranslate = prevTranslate + moveX;
        currentTranslate = Math.max(Math.min(currentTranslate, maxTranslate), minTranslate);
        carousel.css('transform', `translateX(${currentTranslate}px)`);
      }

      function handleDragEnd() {
        if (isDragging) {
          isDragging = false;
          prevTranslate = currentTranslate;
          carousel.css('transition', ''); // Re-enable transitions
        }
      }

      // Touch events for mobile devices
      carousel[0].addEventListener('touchstart', handleDragStart, false);
      carousel[0].addEventListener('touchmove', handleDragMove, false);
      carousel[0].addEventListener('touchend', handleDragEnd, false);

      // Mouse events for desktops
      carousel[0].addEventListener('mousedown', handleDragStart, false);
      document.addEventListener('mousemove', handleDragMove, false);
      document.addEventListener('mouseup', handleDragEnd, false);
    });
  </script> -->